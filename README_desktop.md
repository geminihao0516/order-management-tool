# 📋 訂單資料整理工具

> 專業的訂單資料處理系統，支援自動展開品項、雙欄排版、統計分析、差異比對
>
> ⭐ **現已推出圖形介面版本！** 操作更簡單、更直覺！

---

## 🎯 核心功能

✅ **智慧展開**：自動將「鬼王x2+三鬼頭x4」展開成6筆獨立明細
✅ **雙欄排版**：A4紙張雙欄設計，節省紙張成本
✅ **精準統計**：自動彙總所有品項數量
✅ **差異比對**：與參考數據比對，標示差異
✅ **異常檢測**：自動偵測重複訂購品項
✅ **即時報表**：生成Markdown格式完整報表

---

## 📁 檔案結構

```
📦 訂單整理工具
├── 🎨 order_formatter_gui.py      # GUI圖形介面版（最推薦）⭐⭐⭐
├── 📜 啟動GUI.command              # GUI快速啟動檔（雙擊執行）
├── 📄 order_formatter_simple.py   # 命令列簡易版
├── 📄 order_formatter.py          # 命令列完整版
├── 📄 範例資料.txt                # 測試用範例訂單
├── 📄 範例參考數據.txt            # 測試用參考數據
├── 📖 README.md                   # 本檔案（專案總覽）
├── 📖 GUI使用說明.md              # GUI版本使用說明⭐
├── 📖 快速開始.md                 # 命令列版快速上手指南
└── 📖 使用說明.md                 # 命令列版完整功能文件
```

---

## ⚡ 30秒快速開始

### 🎨 方法 1：圖形介面版（最推薦）

#### 步驟 1：雙擊啟動
找到 `啟動GUI.command` 檔案，**雙擊**執行

#### 步驟 2：一鍵測試
1. 點擊「📋 貼上範例資料」
2. 點擊「📋 貼上範例參考數據」
3. 點擊「🚀 生成報表」

#### 步驟 3：查看結果
報表自動顯示在右側，可儲存或複製

> 📖 詳細說明請參考 [GUI使用說明.md](GUI使用說明.md)

---

### 💻 方法 2：命令列版

#### 1️⃣ 執行程式

```bash
python3 order_formatter_simple.py
```

#### 2️⃣ 使用範例資料測試

當系統詢問時，依序輸入：
- `y` （使用範例資料）
- `y` （使用範例參考數據）
- `n` （不開啟報表）

#### 3️⃣ 查看報表

自動生成的報表檔名：`訂單報表_日期時間.md`

---

## 📊 完整報表內容

生成的報表包含以下7個部分：

| 部分 | 內容 |
|-----|------|
| 📈 **報表摘要** | 生成時間、總訂單數、總品項數、異常訂單數 |
| 📋 **左欄明細表** | 編號 1 ~ N/2 的詳細資料 |
| 📋 **右欄明細表** | 編號 N/2+1 ~ N 的詳細資料 |
| 📊 **品項統計表** | 所有品項的彙總數量 |
| 🔍 **差異比對表** | 系統統計 vs 參考數據（可選） |
| ⚠️ **異常訂單表** | 重複品項的異常訂單（若有） |
| 📈 **統計摘要** | 報表生成資訊 |

---

## 💡 實際使用範例

### 範例輸入（Excel格式）

| 品項 | 姓名/生日 | 對象/生日 | 願望 |
|------|-----------|-----------|------|
| 鬼王x2+三鬼頭x4 | 王小明/1990.05.20 | 李美麗/1992.08.15 | 事業順利、家庭和睦 |
| 愛神x3 | 陳大華/1985.12.10 | — | 求好姻緣 |

### 自動展開結果

| 編號 | 品項 | 姓名/生日 | 對象/生日 | 願望 |
|------|------|-----------|-----------|------|
| 1 | 鬼王 | 王小明/1990.05.20 | 李美麗/1992.08.15 | 事業順利、家庭和睦 |
| 2 | 鬼王 | 王小明/1990.05.20 | 李美麗/1992.08.15 | 事業順利、家庭和睦 |
| 3 | 三鬼頭 | 王小明/1990.05.20 | 李美麗/1992.08.15 | 事業順利、家庭和睦 |
| 4 | 三鬼頭 | 王小明/1990.05.20 | 李美麗/1992.08.15 | 事業順利、家庭和睦 |
| 5 | 三鬼頭 | 王小明/1990.05.20 | 李美麗/1992.08.15 | 事業順利、家庭和睦 |
| 6 | 三鬼頭 | 王小明/1990.05.20 | 李美麗/1992.08.15 | 事業順利、家庭和睦 |
| 7 | 愛神 | 陳大華/1985.12.10 | — | 求好姻緣 |
| 8 | 愛神 | 陳大華/1985.12.10 | — | 求好姻緣 |
| 9 | 愛神 | 陳大華/1985.12.10 | — | 求好姻緣 |

### 統計結果

| 品項名稱 | 數量 |
|----------|------|
| 鬼王 | 2 |
| 三鬼頭 | 4 |
| 愛神 | 3 |
| **總計** | **9** |

---

## 🔧 資料準備指南

### Excel 準備步驟

1. **建立4欄**：品項、姓名/生日、對象/生日、願望
2. **填入資料**（參考範例格式）
3. **選取資料**（不含標題列）
4. **複製** (Ctrl+C 或 Cmd+C)
5. **執行程式**，貼上資料
6. **輸入 `END`** 結束

### 品項格式規則

| ✅ 正確格式 | ❌ 錯誤格式 | 說明 |
|------------|------------|------|
| `鬼王x3` | `鬼王*3` | 使用 x 或 × |
| `鬼王x2+三鬼頭x4` | `鬼王2支+三鬼頭4支` | 標準格式 |
| `愛神 x 2` | `愛神 2` | 可有空格 |
| `鬼王x2、三鬼頭x3` | `鬼王x2 三鬼頭x3` | 用+、，分隔 |

---

## 📖 詳細文件

### ⭐ 必讀文件（遇到問題先看這裡）
- 📝 [資料格式說明.md](資料格式說明.md) - 資料格式完整說明⚠️
- 🔧 [故障排除指南.md](故障排除指南.md) - 常見問題解決方案⚠️
- 📋 [快速參考卡.md](快速參考卡.md) - 快速查閱卡片

### GUI 圖形介面版（推薦）
- 🎨 [GUI使用說明.md](GUI使用說明.md) - GUI版本完整使用指南

### 命令列版
- 🚀 [快速開始.md](快速開始.md) - 5分鐘快速上手指南
- 📚 [使用說明.md](使用說明.md) - 完整功能說明文件

---

## 🎨 列印設定建議

### Word 設定

1. **字型**：微軟正黑體 9pt
2. **行距**：1.1 倍行距
3. **版面**：
   - 2 欄排版
   - 欄間距 0.5cm
   - 窄邊界（1.27cm）
4. **方向**：直向（A4）

### 效果預覽

```
┌─────────────────────┬─────────────────────┐
│      左欄（1-17）    │     右欄（18-34）    │
│ ┌─┬────┬──────┬──┐  │ ┌─┬────┬──────┬──┐  │
│ │1│鬼王│王小明  │...│  │ │18│愛神│劉美玲  │...│ │
│ │2│鬼王│王小明  │...│  │ │19│直立│吳建國  │...│ │
│ └─┴────┴──────┴──┘  │ └─┴────┴──────┴──┘  │
└─────────────────────┴─────────────────────┘
        A4 紙張雙欄排版示意圖
```

---

## 🧪 測試驗證

### 測試程式功能

```bash
# 使用範例資料測試
python3 order_formatter_simple.py
# 依序輸入：y → y → n

# 檢查生成的報表
ls -lh 訂單報表_*.md
```

### 預期結果

- ✅ 載入 10 筆訂單
- ✅ 展開 34 筆明細
- ✅ 統計 4 種品項
- ✅ 偵測差異（直立大鬼 +1）
- ✅ 無異常訂單

---

## ❓ 常見問題

<details>
<summary><b>Q1：為什麼要展開品項？</b></summary>

**A**：為了清楚列出每一支的明細，方便：
- 逐一核對品項
- 分發時不會遺漏
- 清楚對應每支的訂購人和願望
</details>

<details>
<summary><b>Q2：什麼是異常訂單？</b></summary>

**A**：同一筆訂單中，相同品項出現多次。

範例：`鬼王x2+愛神x3+鬼王x1` ← 鬼王出現2次

系統會：
- 標註為異常
- 自動合併計算（鬼王×3）
- 在報表中提醒
</details>

<details>
<summary><b>Q3：如何確保資料正確？</b></summary>

**A**：系統提供三重驗證：
1. **自動統計** - 彙總所有品項數量
2. **差異比對** - 與參考數據核對
3. **異常檢測** - 標示重複訂購
</details>

<details>
<summary><b>Q4：支援哪些資料來源？</b></summary>

**A**：支援多種輸入方式：
- ✅ Excel 直接複製貼上
- ✅ 多行格式轉換
- ✅ 手動逐行輸入
- ✅ 範例資料測試
</details>

---

## 🔄 版本資訊

| 版本 | 日期 | 更新內容 |
|------|------|---------|
| **v1.4** | **2025-11-03** | **🎉 整合多行格式轉換功能到 GUI** |
| v1.3 | 2025-11-03 | ✨ 支援新的參考數據格式（87支鬼王） |
| v1.2 | 2025-11-03 | 🐛 修復「0筆訂單」問題，新增格式驗證 |
| v1.1 | 2025-01-03 | ⭐ 新增GUI圖形介面版本 |
| v1.0 | 2025-01-03 | 初始版本，核心功能完整 |

---

## 📞 技術支援

- 📧 Email：聯絡系統管理員
- 📝 文件：查看「使用說明.md」
- 🐛 問題回報：記錄錯誤訊息並聯繫管理員

---

## 📜 授權與聲明

本工具為內部使用，請勿外流。

**開發者**：資料整理專家團隊
**最後更新**：2025-01-03

---

<div align="center">

**🎉 祝您使用愉快！**

如有任何問題或建議，歡迎隨時反饋

</div>
