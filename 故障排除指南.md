# 🔧 故障排除指南

## 問題 1：顯示「0 筆訂單」或「0 支品項」

### 症狀
點擊「生成報表」後，結果顯示：
- 總訂單數：0 筆
- 總品項數：0 支

### 原因
**99% 的情況是資料格式不正確！**

### 解決方案

#### 方案 A：使用範例資料測試（推薦）

1. 清空輸入框
2. 點擊「📋 貼上範例資料」
3. 點擊「🚀 生成報表」
4. 如果成功 → 你的資料格式有問題
5. 對照範例資料，調整你的資料格式

#### 方案 B：從 Excel 重新準備資料

1. 開啟 Excel
2. 建立表格：

| 品項 | 姓名/生日 | 對象/生日 | 願望 |
|------|-----------|-----------|------|
| 鬼王x2+三鬼頭x4 | 王小明/1990.05.20 | 李美麗/1992.08.15 | 事業順利 |

3. 選取**資料列**（不要選標題）
4. 按 `Ctrl+C` (Win) 或 `Cmd+C` (Mac)
5. 到 GUI 貼上
6. 再次生成報表

#### 方案 C：檢查資料格式

打開「記事本」或「文字編輯器」：

**錯誤範例**（用空白鍵分隔）：
```
鬼王x2+三鬼頭x4 王小明/1990.05.20 李美麗/1992.08.15 事業順利
```
↑ 這樣是**錯誤**的！

**正確範例**（用 Tab 分隔）：
```
鬼王x2+三鬼頭x4<Tab>王小明/1990.05.20<Tab>李美麗/1992.08.15<Tab>事業順利
```
↑ 欄位之間應該有**明顯的間距**（Tab）

---

## 問題 2：資料格式錯誤提示

### 症狀
彈出錯誤訊息：
```
❌ 未偵測到正確的訂單資料格式！
```

### 原因
資料中沒有任何 Tab 分隔符號

### 解決方案

1. **不要手動輸入空白鍵！**
2. **從 Excel 複製資料**（最簡單）
3. 或在每個欄位之間按 **Tab 鍵**

---

## 問題 3：部分資料無法解析

### 症狀
顯示：
```
⚠️ 已讀取 10 行資料，但只解析出 3 筆訂單
```

### 原因
某些行的格式不正確或欄位不足

### 解決方案

1. 檢查每行至少有 **2 欄**（品項、姓名/生日）
2. 確保沒有空白行
3. 確保每行都用 Tab 分隔

**檢查方法**：
```
正確：鬼王x3<Tab>王小明/1990.05.20<Tab>李美麗<Tab>事業順利
錯誤：鬼王x3                          （只有 1 欄）
錯誤：鬼王x3 王小明/1990.05.20         （用空白鍵分隔）
```

---

## 問題 4：品項數量不正確

### 症狀
統計的品項數量跟預期不同

### 原因 A：品項格式錯誤

**錯誤範例**：
```
❌ 鬼王*3        → 會被當成 1 支「鬼王*3」
❌ 鬼王 3支       → 會被當成 1 支「鬼王 3支」
❌ 鬼王2          → 會被當成 1 支「鬼王2」
```

**正確範例**：
```
✅ 鬼王x3        → 展開成 3 支鬼王
✅ 鬼王 x 3      → 展開成 3 支鬼王
```

### 原因 B：多品項連接符號錯誤

**錯誤範例**：
```
❌ 鬼王x2 三鬼頭x4    → 只會識別「鬼王x2」
```

**正確範例**：
```
✅ 鬼王x2+三鬼頭x4   → 2支鬼王 + 4支三鬼頭
✅ 鬼王x2、三鬼頭x4  → 2支鬼王 + 4支三鬼頭
✅ 鬼王x2,三鬼頭x4   → 2支鬼王 + 4支三鬼頭
```

---

## 問題 5：無法開啟 GUI

### 症狀
雙擊「啟動GUI.command」沒有反應

### 解決方案

#### 方案 A：從終端機啟動

```bash
cd ~/Desktop/訂單整理工具
python3 order_formatter_gui.py
```

查看錯誤訊息

#### 方案 B：檢查 Python 環境

```bash
python3 --version
```

應該顯示 Python 3.6 或更高版本

#### 方案 C：檢查檔案權限

```bash
chmod +x ~/Desktop/訂單整理工具/啟動GUI.command
```

---

## 問題 6：貼上資料後格式跑掉

### 症狀
資料貼上後看起來很亂

### 原因
可能是從網頁或 Word 複製的資料帶有格式

### 解決方案

1. **先貼到 Excel**
2. 整理成 4 欄格式
3. 再從 Excel 複製到 GUI

---

## 問題 7：範例資料按鈕沒反應

### 症狀
點擊「貼上範例資料」沒反應

### 原因
找不到「範例資料.txt」檔案

### 解決方案

檢查檔案是否存在：
```bash
ls ~/Desktop/訂單整理工具/範例資料.txt
```

如果不存在，請重新下載完整專案

---

## 問題 8：無法儲存報表

### 症狀
點擊「儲存報表」出現錯誤

### 原因
儲存路徑沒有寫入權限

### 解決方案

1. 儲存到桌面或文件資料夾
2. 確保資料夾存在
3. 檢查磁碟空間是否足夠

---

## 問題 9：中文顯示亂碼

### 症狀
報表中的中文顯示為亂碼

### 原因
檔案編碼問題

### 解決方案

1. 確保資料檔案使用 **UTF-8** 編碼
2. 從 Excel 重新複製資料
3. 使用支援 UTF-8 的編輯器

---

## 🔍 快速診斷流程圖

```
開始
  ↓
點擊「貼上範例資料」
  ↓
點擊「生成報表」
  ↓
是否成功？
  ↓
【是】→ 你的資料格式有問題 → 對照範例調整
  ↓
【否】→ 程式有問題 → 查看錯誤訊息 → 聯繫支援
```

---

## 💡 預防問題的最佳實踐

### ✅ 推薦作法

1. **永遠從 Excel 準備資料**
   - 建立 4 欄表格
   - 填入資料
   - 直接複製貼上

2. **先測試範例資料**
   - 確認程式正常運作
   - 再處理實際資料

3. **保持資料格式一致**
   - 品項格式：`名稱x數量`
   - 日期格式：`YYYY.MM.DD` 或 `YYYY/MM/DD`

### ❌ 避免的作法

1. **不要手動輸入空白鍵**
2. **不要從網頁直接複製**
3. **不要省略 x 符號**
4. **不要混用不同分隔符號**

---

## 📞 仍然無法解決？

### 收集以下資訊

1. 錯誤訊息截圖
2. 你的資料格式範例（前3行）
3. 作業系統版本
4. Python 版本

### 檢查清單

- [ ] 已使用範例資料測試
- [ ] 資料使用 Tab 分隔
- [ ] 品項格式正確（例如：鬼王x3）
- [ ] 從 Excel 複製資料
- [ ] 已閱讀「資料格式說明.md」

---

<div align="center">

**90% 的問題都是資料格式造成的！**

記住：**Tab 分隔 + Excel 複製 = 萬無一失**

</div>
