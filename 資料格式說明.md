# 📝 訂單資料格式說明

## ❗ 重要提醒

**你輸入的資料格式必須使用 Tab 分隔，不是空白鍵！**

---

## ✅ 正確的資料格式

### 格式規則

```
品項<Tab>姓名/生日<Tab>對象/生日<Tab>願望
```

**說明**：
- `<Tab>` = 按鍵盤上的 Tab 鍵（不是多個空白鍵）
- 每一欄之間必須用 **Tab** 分隔
- 至少需要前 2 欄（品項、姓名/生日）
- 後面 2 欄是選填（對象/生日、願望）

---

## 📊 從 Excel 準備資料（最推薦）

### 步驟 1：在 Excel 建立表格

| 品項 | 姓名/生日 | 對象/生日 | 願望 |
|------|-----------|-----------|------|
| 鬼王x2+三鬼頭x4 | 王小明/1990.05.20 | 李美麗/1992.08.15 | 事業順利、家庭和睦 |
| 愛神x3 | 陳大華/1985.12.10 | — | 求好姻緣 |
| 直立大鬼x1 | 林小芳/1995.03.25 | 父親/1960.01.05 | 身體健康 |

### 步驟 2：選取資料

1. 選取**資料列**（不要包含標題列）
2. 按 `Ctrl+C` (Windows) 或 `Cmd+C` (Mac) 複製

### 步驟 3：貼到 GUI

1. 點擊 GUI 的「訂單資料輸入」區域
2. 按 `Ctrl+V` (Windows) 或 `Cmd+V` (Mac) 貼上
3. ✅ 完成！Excel 會自動使用 Tab 分隔

---

## 📋 範例資料

### 範例 1：單一品項

```
愛神x3	陳大華/1985.12.10	—	求好姻緣
```

**解說**：
- `愛神x3` = 品項（3支愛神）
- `陳大華/1985.12.10` = 姓名/生日
- `—` = 對象（無對象用 — 表示）
- `求好姻緣` = 願望

### 範例 2：多個品項

```
鬼王x2+三鬼頭x4	王小明/1990.05.20	李美麗/1992.08.15	事業順利、家庭和睦
```

**解說**：
- `鬼王x2+三鬼頭x4` = 多個品項（用 + 連接）
- 會自動展開成 6 筆明細（2筆鬼王 + 4筆三鬼頭）

### 範例 3：完整範例（可直接複製測試）

**注意**：以下使用 `<Tab>` 標示，實際使用時請按 Tab 鍵

```
鬼王x2+三鬼頭x4<Tab>王小明/1990.05.20<Tab>李美麗/1992.08.15<Tab>事業順利、家庭和睦
愛神x3<Tab>陳大華/1985.12.10<Tab>—<Tab>求好姻緣
直立大鬼x1<Tab>林小芳/1995.03.25<Tab>父親/1960.01.05<Tab>身體健康
```

---

## 🎯 品項格式規則

### 基本格式（支援多種寫法）✨

| 格式 | 說明 | 展開結果 |
|------|------|---------|
| `鬼王x3` | x 格式（小寫） | 3筆鬼王明細 |
| `鬼王X3` | X 格式（大寫） | 3筆鬼王明細 |
| `鬼王×3` | × 格式（乘號） | 3筆鬼王明細 |
| `鬼王*3` | * 格式（星號）✨ | 3筆鬼王明細 |
| `鬼王 3` | 純空格格式 ✨ | 3筆鬼王明細 |
| `愛神 x 2` | 可以有空格 | 2筆愛神明細 |

**說明**：
- ✨ = v1.5 新增格式
- 所有格式都可以使用，選擇你習慣的即可
- 純空格格式數量限制：1-999

### 多品項格式

| 格式 | 說明 | 展開結果 |
|------|------|---------|
| `鬼王x2+三鬼頭x4` | 用 + 連接 | 2筆鬼王 + 4筆三鬼頭 |
| `鬼王x2、三鬼頭x4` | 用、連接 | 2筆鬼王 + 4筆三鬼頭 |
| `鬼王x2,三鬼頭x4` | 用 , 連接 | 2筆鬼王 + 4筆三鬼頭 |
| `鬼王*2+三鬼頭 4` | 混合格式 ✨ | 2筆鬼王 + 4筆三鬼頭 |

### ✅ 正確範例

```
✅ 鬼王x3                      （x 格式）
✅ 鬼王*3                      （* 格式）✨
✅ 鬼王 3                      （純空格）✨
✅ 鬼王 x 3                    （有空格）
✅ 鬼王x2+三鬼頭x4             （多品項）
✅ 鬼王*2+三鬼頭 4             （混合格式）✨
✅ 愛神x1+直立大鬼*2+三鬼頭 5  （全部混合）✨
```

### ❌ 錯誤範例

```
❌ 鬼王 3支         （不要加「支」字）
❌ 鬼王2+三鬼頭4    （缺少符號或空格）
❌ 鬼王x2 三鬼頭x4  （品項之間要用 +、，連接）
❌ 鬼王 1234        （純空格格式數量限制1-999）
```

---

## 🔍 如何檢查資料格式

### 方法 1：使用範例資料測試

1. 點擊 GUI 的「📋 貼上範例資料」
2. 查看輸入框中的格式
3. 點擊「🚀 生成報表」測試
4. 如果成功，你的資料應該用相同格式

### 方法 2：檢查分隔符號

在文字編輯器中：
1. 複製你的資料
2. 貼到記事本或文字編輯器
3. 檢查欄位之間是否有「Tab」（會顯示為較大的空白）
4. 如果只看到普通空格，那就是錯誤格式

---

## 📝 常見資料來源處理方式

### 1. 從 Excel 複製（最推薦）✅

```
Excel → 選取資料 → Ctrl+C → GUI貼上 → ✅ 自動正確
```

### 2. 從 Word 表格複製 ✅

```
Word表格 → 選取 → Ctrl+C → GUI貼上 → ✅ 通常正確
```

### 3. 從純文字檔 ⚠️

需要確保：
- 使用 Tab 分隔（不是空白鍵）
- 每行格式一致

### 4. 手動輸入 ⚠️

每輸入完一個欄位後：
- 按 **Tab 鍵**（不是空白鍵）
- 然後輸入下一個欄位

---

## 🐛 錯誤排查

### 問題 1：顯示「0 筆訂單」

**原因**：資料格式不正確

**解決方法**：
1. 檢查是否使用 Tab 分隔
2. 點擊「📋 貼上範例資料」查看正確格式
3. 從 Excel 重新複製資料

### 問題 2：資料貼上後顯示亂碼或格式跑掉

**原因**：可能是文字編碼問題

**解決方法**：
1. 確保檔案使用 UTF-8 編碼
2. 從 Excel 重新複製資料
3. 避免從網頁直接複製

### 問題 3：部分資料無法解析

**原因**：某些行的欄位數不足

**解決方法**：
1. 確保每行至少有 2 欄（品項、姓名/生日）
2. 如果某欄沒有資料，用 `—` 代替
3. 檢查是否有空白行

---

## 💡 最佳實踐

### ✅ 推薦作法

1. **在 Excel 中準備資料**
   - 建立 4 欄：品項、姓名/生日、對象/生日、願望
   - 填入資料
   - 直接複製貼上到 GUI

2. **使用範例資料測試**
   - 先點擊「📋 貼上範例資料」
   - 確認程式正常運作
   - 再處理實際資料

3. **分批處理大量資料**
   - 每次處理 50-100 筆
   - 避免一次貼入太多資料

### ❌ 避免的作法

1. **不要使用空白鍵分隔**
   - 空白鍵無法被正確識別
   - 一定要使用 Tab

2. **不要直接從網頁複製**
   - 可能帶有格式或特殊字元
   - 建議先貼到 Excel 整理

3. **不要省略必要欄位**
   - 至少要有品項和姓名/生日
   - 如果某欄沒資料，用 `—` 代替

---

## 📞 仍然有問題？

### 快速測試步驟

1. 清空輸入框
2. 點擊「📋 貼上範例資料」
3. 點擊「🚀 生成報表」
4. 如果範例資料可以運作，對照檢查你的資料格式

### 檢查清單

- [ ] 資料使用 Tab 分隔（不是空白鍵）
- [ ] 每行至少有 2 欄
- [ ] 品項格式正確（例如：鬼王x3）
- [ ] 沒有空白行
- [ ] 從 Excel 複製的資料

---

<div align="center">

**記住：Tab 分隔是關鍵！**

建議從 Excel 複製資料，最簡單也最不會出錯！

</div>

---

## 🔍 參考數據格式說明

參考數據用於與系統統計的品項數量進行比對。

### 支援的格式

**格式 A（數量在前）**：推薦！
```
87支鬼王
101支三鬼頭
24支直立大鬼
45支愛神
```

**格式 B（數量在後）**：
```
鬼王 87 支
三鬼頭 101 支
直立大鬼 24 支
愛神 45 支
```

**格式 C（逗號分隔）**：
```
鬼王 87 支、三鬼頭 101 支、直立大鬼 24 支、愛神 45 支
```

### 分隔符號

可以使用：
- ✅ 換行（每個品項一行）
- ✅ 逗號（、或 ,）
- ✅ 頓號（、）

### 範例

**範例 1：換行分隔（推薦）**
```
87支鬼王
101支三鬼頭
24支直立大鬼
19支大鬼頭
3支愛神
```

**範例 2：逗號分隔**
```
87支鬼王、101支三鬼頭、24支直立大鬼、19支大鬼頭、3支愛神
```

**範例 3：混合格式（也支援！）**
```
87支鬼王
三鬼頭 101 支
24支直立大鬼、愛神 19 支
```

---

## 📌 重點提醒

### 訂單資料格式
- ✅ 必須使用 **Tab** 分隔
- ✅ 從 Excel 複製最簡單
- ✅ 品項格式：`名稱x數量`（例如：鬼王x3）

### 參考數據格式
- ✅ 兩種格式都支援（數量在前/在後）
- ✅ 可用換行或逗號分隔
- ✅ 「支」字可加可不加

